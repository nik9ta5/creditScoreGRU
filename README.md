# Репозиторий с решением задачи кредитного скоринга

## Описание репозитория

### Файлы:
* `my_train_pipe.py` - обучение сети
* `submission_script.py` - отправка решения
* `data_analysis.ipynb` - блокнот для анализа данных

### Директории:
* `GRUmodel/` - архитектура сети
* `logs/` - директория для логов
* `models/` - директория для сохранения моделей (оставил специально последнюю модель)
* `test_data/` - тестовые данные (поместить в данную директорию данные для предсказаний)
* `train_data/` - тренировочные данные (поместить в данную директорию данные для обучения)

### Доп. файлы:
* `requirements.txt` - файл с requirements
* `embeddings_dims.json` - для размерностей эмбеддингов
* `info_len_taget.csv` - ID-шники, таргеты и длины истории для каждого клиента
* `test_target.csv` - ID-шники, для которых делать предсказания
* `train_target.csv` - ID-шники и таргеты

Графики распределения длин историй клиентов в `data_analysis.ipynb`

## Комментарии
Перед решением был проведен анализ данных, было определено:
* количество уникальных клиентов
* количество взаимодействий для каждого клиента с банком (длинна истории)
* дисбаланс классов (0 - 2893558; 1 - 106442) (указано уникальное число клиентов, всего 3kk)

Была разработана архитектура сети, с использованием GRU слоев.
Было реализовано логирование, для каждого запуска обучения. В соответствующих файлах логов можно ознакомиться с параметрами, которые были использованы для обучения.

Конфигурация сети, с которой был достигнут лучший результат на валидационной выборке:
hidden_size = 512, количество количество слоёв gru = 3, без использования biderectional.

Файл с логами: `./logs/TRAIN_model_01-06-2025_18-10-37.log`

## Запуск
1. Клонируйте репозиторий git clone ...
2. Перенесите файлы для тренировки и тестирования в соответствующие директории
* `test_data/` - тестовая дата (поместить в данную директорию данные для предсказаний)
* `train_data/` - тренировочная (поместить в данную директорию данные для обучения)
* добавьте в репозиторий `test_target.csv`
* добавьте в репозиторий `train_target.csv`

3. Перейдите в директорию проекта (cd ..)
4. Создайте виртуальное окружение (при необходимости) и установите зависимости
pip install -r requirements.txt

5. При необходимости отредактируйте (`TRAIN_DATA_DIR` и `TEST_DATA_DIR`)

---
Для обучения: запустите: `my_train_pipe.py`
(в логах можно найти пути сохранения моделей, для дальнейшего использования)

Для предсказания запустите: установите путь до желаемой модели в `path2load_model` в `submission_script.py` и запустите (python submission_script.py)

PS: в `submission_script.py` - установлен путь до самой последней версии модели.

PS: logs/ and models/ специально не игнорируются, чтобы отправить веса (если нужны)